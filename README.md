# The epidemiology of pathogens with pandemic potential: A review of key parameters and clustering analysis 

This project implements a Monte Carlo approach combined with K-means clustering to identify distinct pathogen archetypes based on epidemiological parameters. The analysis accounts for parameter uncertainty through probabilistic sampling and provides robust clustering results through ensemble methods.

## Project Overview

The goal is to classify infectious disease pathogens into distinct archetypes based on their epidemiological characteristics, including:
- **R0 (Basic Reproduction Number)**: Transmission potential
- **Serial Interval (SI)**: Time between symptom onset in successive cases
- **Case Fatality Rate (CFR)**: Proportion of cases that result in death
- **Presymptomatic Transmission Proportion**: Fraction of transmission occurring before symptom onset
- **Transmission Route**:
  
## Project Structure and Workflow

This repository is organized into two main components:
1.  **Parameter Estimation**: Scripts to derive key epidemiological parameters from literature and outbreak data.
2.  **Clustering Analysis**: Scripts to classify pathogens into archetypes based on their epidemiological profiles. The analysis is located in the `Clustering/mcmc/` directory and is structured as follows:
    -   **`Scripts/`**: Contains the R scripts for performing the analysis.
        -   `Main/`: Scripts for the primary analysis and main figures.
        -   `sensitivity_analysis/`: Scripts for supplementary figure generation.
    -   **`Kmeans/`**: Contains all input data, results, and figures generated by the clustering scripts.

## Clustering Analysis Scripts

### 1. Main Analysis (`Clustering/mcmc/Scripts/Main/`)
-   **`mcmc_Kmeans_analysis.R`**: Performs the complete MCMC K-means clustering analysis (K=6), including parameter sampling, per-iteration clustering, and consensus clustering.
-   **`find_optimal_K.R`**: Determines the optimal number of clusters (K) using the silhouette method based on the dissimilarity matrix from the main analysis.

### 2. Sensitivity Analysis (`Clustering/mcmc/Scripts/sensitivity_analysis/`)
-   **`supplementary_figure_S6.R`**, **`supplementary_figure_S7.R`**, **`supplementary_figure_S9.R`**: These scripts test the robustness of the clustering results by varying the included pathogens and parameters, generating supplementary figures for this paper.

## Parameter Estimation Scripts

### 1. CCHF R0 and Serial Interval Estimation
- **Location**: `param_estimation/CCHF/`
- **`CCHF_R_calc.R`**: Estimates the basic reproduction number (R0) for Crimean-Congo Haemorrhagic Fever (CCHF) from cluster size data using an MCMC approach.
- **`Fit_CCHF_si_distributions.R`**: Fits parametric distributions (Gamma and Lognormal) to CCHF serial interval data to estimate its mean and uncertainty.

### 2. Lassa Fever Serial Interval Estimation
- **Location**: `param_estimation/Lassa/`
- **`fit_lassa_si_distributions.R`**: Fits Gamma and Lognormal distributions to Lassa fever serial interval data to characterise the time between successive cases.

### 3. Presymptomatic Transmission Estimation (Legacy)
- **Location**: `param_estimation/old_presym/`
- **Purpose**: Contains a collection of legacy scripts used to calculate the proportion of presymptomatic transmission for various pathogens (e.g., Ebola, MERS, SARS-CoV-2 variants).
- **Method**: These scripts use probability density functions of the incubation period and serial interval to estimate the extent of transmission before symptom onset.

## Data Requirements

### Input Files
- `pathogen_params_kmeans.csv`: Main parameter file with 19 pathogens
- `pathogen_params_RVFV.csv`: Extended dataset including RVFV
- `pathogen_params_HIV.csv`: Extended dataset including HIV

### Parameter Structure
Each pathogen requires:
- **Clustered Parameters**: R0, SI, CFR with uncertainty information
- **Full Distribution Parameters**: SI and IP distributions for presymptomatic calculation
- **Transmission Routes**: The categorical transmission route data was encoded using one-hot encoding. Each potential route (e.g., respiratory, direct contact, vector-borne) was represented as a separate binary feature (1 for presence, 0 for absence). These indicators were treated as fixed parameters for each pathogen across all Monte Carlo simulations.
- **Uncertainty Types**: Point estimates, confidence intervals, or ranges
- **Sampling Distributions**: Normal, beta, gamma, lognormal, or uniform

## Key Methodological Features

### Uncertainty Handling
- **Probabilistic Sampling**: Accounts for parameter uncertainty through MCMC
- **Multiple Distribution Types**: Supports various uncertainty representations
- **Robust Fallbacks**: Handles edge cases and missing data gracefully

### Clustering Approach
- **Ensemble Method**: Combines results across 5,000 MCMC iterations
- **Consensus Clustering**: Uses hierarchical clustering on co-assignment frequencies
- **Scaled Features**: Normalizes numerical parameters for clustering
- **Modal Assignments**: Determines most frequent cluster for each pathogen

### Validation Methods
- **Silhouette Analysis**: Evaluates clustering quality
- **Sensitivity Testing**: Assesses robustness to parameter inclusion/exclusion
- **Visual Assessment**: PCA plots and dendrograms for interpretation

## Output Interpretation

### Cluster Characteristics
- **Centroids**: Mean parameter values for each cluster
- **Confidence Intervals**: 95% CI across MCMC iterations
- **Route Profiles**: Average transmission route patterns

### Consensus Results
- **Stable Assignments**: Pathogens consistently grouped together
- **Cluster Stability**: Frequency of co-assignment across iterations
- **Hierarchical Structure**: Dendrogram showing pathogen relationships

## Usage Instructions

1. **Run Main Analysis**:
   ```r
   source("Clustering/mcmc/mcmc_Kmeans_analysis.R")
   ```

2. **Find Optimal K** (after main analysis):
   ```r
   source("Clustering/mcmc/find_optimal_K.R")
   ```

3. **Run Sensitivity Analysis**:
   ```r
   source("Clustering/mcmc/mcmc_sensitivity_analyis.R")
   ```

## Dependencies

Required R packages:
- `dplyr`, `readr`: Data manipulation
- `stats`: Statistical functions and clustering
- `cluster`: Silhouette analysis
- `ggplot2`, `factoextra`, `ggrepel`: Visualization
- `dendextend`, `RColorBrewer`: Enhanced dendrograms

## File Structure

```
.
├── Clustering/
│   └── mcmc/
│       ├── Scripts/
│       │   ├── Main/                 # Main analysis scripts
│       │   └── sensitivity_analysis/ # Supplementary figure scripts
│       └── Kmeans/
│           ├── data/                 # Input data for clustering
│           ├── figures/              # Resulting figures
│           └── main_outputs/         # Output files from scripts
└── param_estimation/
    ├── CCHF/                     # CCHF R0 and SI estimation
    ├── Lassa/                    # Lassa SI estimation
    └── old_presym/               # Legacy presymptomatic estimation scripts
```

This project provides a robust, uncertainty-aware approach to pathogen classification that can inform public health decision-making and outbreak response strategies.
