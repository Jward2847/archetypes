# The epidemiology of pathogens with pandemic potential: A review of key parameters and clustering analysis 

This is the R script for the paper "The epidemiology of pathogens with pandemic potential: "A review of key parameters and clustering analysis" currently a preprint hosted at MedRxiv https://www.medrxiv.org/content/10.1101/2025.03.13.25323659v2.

We use a Monte Carlo approach combined with K-means clustering to identify distinct pathogen archetypes based on epidemiological parameters. The analysis accounts for parameter uncertainty through probabilistic sampling and provides robust clustering results through ensemble methods. 

## Project Overview

We aim to classify infectious disease pathogens into distinct archetypes based on their epidemiological characteristics, including: reproduction number, dispersion parameter, serial interval, incubation period, latent period, infectious period, case fatality risk and transmission route.

  
## Project Structure and Workflow

This repository is organized into two main components:
1.  **Parameter Estimation**: Scripts to derive key epidemiological parameters from literature and outbreak data.
2.  **Clustering Analysis**: Scripts to classify pathogens into archetypes based on their epidemiological profiles. The analysis is located in the `Clustering/mcmc/` directory and is structured as follows:
    -   **`Scripts/`**: Contains the R scripts for performing the analysis.
        -   `Main/`: Scripts for the primary analysis and main figures.
        -   `sensitivity_analysis/`: Scripts for supplementary figure generation.
    -   **`Kmeans/`**: Contains all input data, results, and figures generated by the clustering scripts.

## Clustering Analysis Scripts

### 1. Main Analysis (`Clustering/mcmc/Scripts/Main/`)
-   **`main_manuscript.R`**: Performs the complete MCMC K-means clustering analysis. This single script handles parameter sampling, performs clustering for each MCMC iteration, and then conducts an ensemble consensus clustering analysis. For the consensus clustering, it automatically determines the optimal number of clusters (K) using the silhouette method, and generates outputs for multiple K values (e.g., K=4, 5, 6) for robustness checking.

### 2. Sensitivity Analysis (`Clustering/mcmc/Scripts/sensitivity_analysis/`)
-   **`S5-S8.R`**: Reducing input parameters to R, SI and CFR including/excluding the proportion of presymptomatic transmission. It generates supplementary figures S5, S6, S7, and S8.
-   **`S9-S10.R`**: Assesses the clustering structure when including the proportion of presymptomatic transmission to the main parameters set. It generates supplementary figures S9 and S10.
-   **`S11.R`**: Explores the clustering archetypes when the analysis is expanded to a larger set of 32 pathogens, using a reduced set of core parameters (R0, CFR, and IP). It generates supplementary figure S11.

## Parameter Estimation Scripts

### 1. CCHF R0 and Serial Interval Estimation
- **Location**: `param_estimation/CCHF/`
- **`CCHF_R_calc.R`**: Estimates the basic reproduction number (R0) for Crimean-Congo Haemorrhagic Fever (CCHF) from cluster size data using an MCMC approach.
- **`Fit_CCHF_si_distributions.R`**: Fits parametric distributions (Gamma and Lognormal) to CCHF serial interval data to estimate its mean and uncertainty.

### 2. Lassa Fever Serial Interval Estimation
- **Location**: `param_estimation/Lassa/`
- **`fit_lassa_si_distributions.R`**: Fits Gamma and Lognormal distributions to Lassa fever serial interval data to characterise the time between successive cases.


## Data Requirements

### Input Files
- `pathogen_params.csv`: Main parameter file used for the primary clustering analysis.
- `pathogen_presym.csv`: Parameter file used for presymptomatic transmission estimation, containing full distribution information for the serial interval (SI) and incubation period (IP).
- `transmission_route.csv`: Contains the encoded transmission route data for each pathogen.


## Usage Instructions

1. **Run Main Analysis**:
   The entire main analysis, including MCMC sampling, per-iteration clustering, consensus clustering, and optimal K determination, is performed by a single script.
   ```r
   source("Clustering/mcmc/Scripts/Main/main_manuscript.R")
   ```

2. **Run Sensitivity Analysis**:
   The sensitivity analyses are run from separate scripts in the `Clustering/mcmc/Scripts/sensitivity_analysis/` directory. For example:
   ```r
   source("Clustering/mcmc/Scripts/sensitivity_analysis/S5-S8.R")
   ```

## Dependencies

Required R packages:
- `dplyr`, `readr`: Data manipulation
- `stats`: Statistical functions and clustering (base R)
- `cluster`: Silhouette analysis
- `ggplot2`, `factoextra`, `ggrepel`: Visualization
- `dendextend`, `RColorBrewer`: Enhanced dendrograms
- `future`, `furrr`: Parallel processing
- `patchwork`, `ggplotify`: Combining and converting plots
- `reshape2`: Data reshaping for plotting

## File Structure

```
.
├── Clustering/
│   └── mcmc/
│       ├── Scripts/
│       │   ├── Main/                 # Main analysis scripts
│       │   └── sensitivity_analysis/ # Supplementary figure scripts
│       └── Kmeans/
│           ├── data/                 # Input data for clustering
│           ├── figures/              # Resulting figures
│           └── main_outputs/         # Output files from scripts
└── param_estimation/
    ├── CCHF/                     # CCHF R0 and SI estimation
    ├── Lassa/                    # Lassa SI estimation
    └── old_presym/               # Legacy presymptomatic estimation scripts
```


